/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/lowering.py:1814: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
  warnings.warn(
Traceback (most recent call last):
  File "<string>", line 3, in get_estimated_runtime_cache_on_self
AttributeError: 'SchedulerNode' object has no attribute '__get_estimated_runtime_cache'. Did you mean: 'get_estimated_runtime'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ywatanabe/proj/gPAC/examples/performance/parameter_sweep/parameter_sweep_benchmark.py", line 551, in <module>
    CONFIG,
  File "/home/ywatanabe/proj/gPAC/examples/performance/parameter_sweep/parameter_sweep_benchmark.py", line 538, in run_main
    sys,
  File "/home/ywatanabe/proj/gPAC/examples/performance/parameter_sweep/parameter_sweep_benchmark.py", line 482, in main
    df_sweep = run_parameter_sweep(args)
  File "/home/ywatanabe/proj/gPAC/examples/performance/parameter_sweep/parameter_sweep_benchmark.py", line 284, in run_parameter_sweep
    time_gpac, _ = benchmark_gpac(
  File "/home/ywatanabe/proj/gPAC/examples/performance/parameter_sweep/parameter_sweep_benchmark.py", line 166, in benchmark_gpac
    _ = pac(data)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ywatanabe/proj/gPAC/src/gpac/_PAC.py", line 217, in forward
    results = self._forward_vectorized(x)
  File "/home/ywatanabe/proj/gPAC/src/gpac/_PAC.py", line 261, in _forward_vectorized
    pac_values = self._compute_mi_vectorized(phase, amplitude)
  File "/home/ywatanabe/proj/gPAC/src/gpac/_PAC.py", line 479, in _compute_mi_vectorized
    mi_result = self.modulation_index(phase_all, amplitude_all)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 574, in _fn
    return fn(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1380, in __call__
    return self._torchdynamo_orig_callable(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1164, in __call__
    result = self._inner_convert(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
    return _compile(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
    return function(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
    out_code = transform_code_object(code, transform)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
    transformations(instructions, code_options)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
    return fn(*args, **kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
    tracer.run()
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
    super().run()
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3048, in RETURN_VALUE
    self._return(inst)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3033, in _return
    self.output.compile_subgraph(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1136, in compile_subgraph
    self.compile_and_call_fx_graph(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1382, in compile_and_call_fx_graph
    compiled_fn = self.call_user_compiler(gm)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1432, in call_user_compiler
    return self._call_user_compiler(gm)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1462, in _call_user_compiler
    compiled_fn = compiler_fn(gm, self.example_inputs())
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 130, in __call__
    compiled_gm = compiler_fn(gm, example_inputs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/__init__.py", line 2340, in __call__
    return compile_fx(model_, inputs_, config_patches=self.config)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1863, in compile_fx
    return aot_autograd(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 83, in __call__
    cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1155, in aot_module_simplified
    compiled_fn = dispatch_and_compile()
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1131, in dispatch_and_compile
    compiled_fn, _ = create_aot_dispatcher_function(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 580, in create_aot_dispatcher_function
    return _create_aot_dispatcher_function(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 830, in _create_aot_dispatcher_function
    compiled_fn, fw_metadata = compiler_fn(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 203, in aot_dispatch_base
    compiled_fw = compiler(fw_module, updated_flat_args)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 489, in __call__
    return self.compiler_fn(gm, example_inputs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1741, in fw_compiler_base
    return inner_compile(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 569, in compile_fx_inner
    return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 102, in debug_wrapper
    inner_compiled_fn = compiler_fn(gm, example_inputs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 685, in _compile_fx_inner
    mb_compiled_graph = fx_codegen_and_compile(
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1129, in fx_codegen_and_compile
    return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1046, in codegen_and_compile
    num_bytes, nodes_num_elem, node_runtimes = graph.count_bytes()
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/graph.py", line 2011, in count_bytes
    node_runtimes.append((node, node.get_estimated_runtime()))
  File "<string>", line 5, in get_estimated_runtime_cache_on_self
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 699, in get_estimated_runtime
    gpu_flops = get_device_tflops(dtype) * 10**12
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_inductor/utils.py", line 1639, in get_device_tflops
    sm_clock = max_clock_rate()
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/torch/_utils_internal.py", line 216, in max_clock_rate
    return nvsmi(["clocks.max.sm"])[0]
  File "/home/ywatanabe/.env-3.10/lib/python3.10/site-packages/triton/testing.py", line 14, in nvsmi
    out = subprocess.check_output(cmd)
  File "/apps/easybuild-2022/easybuild/software/Compiler/GCCcore/11.3.0/Python/3.10.4/lib/python3.10/subprocess.py", line 420, in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
  File "/apps/easybuild-2022/easybuild/software/Compiler/GCCcore/11.3.0/Python/3.10.4/lib/python3.10/subprocess.py", line 501, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/apps/easybuild-2022/easybuild/software/Compiler/GCCcore/11.3.0/Python/3.10.4/lib/python3.10/subprocess.py", line 966, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/apps/easybuild-2022/easybuild/software/Compiler/GCCcore/11.3.0/Python/3.10.4/lib/python3.10/subprocess.py", line 1788, in _execute_child
    os.close(errpipe_write)
KeyboardInterrupt
